# 文件共享服务

## 1.文件共享

![image-20230704091801440](../../.gitbook/assets/fdaee2-0.png)

![image-20230704092834558](../../.gitbook/assets/fcrs4g-0.png)

![image-20230704092850007](../../.gitbook/assets/fd4j8x-0.png)

![image-20230704093111665](../../.gitbook/assets/feej8m-0.png)

![image-20230704093226081](../../.gitbook/assets/ff2ppo-0.png)

## 2.FTP

![image-20230704093603946](../../.gitbook/assets/fhdof7-0.png)

## 3.NFS

![image-20230704100250841](../../.gitbook/assets/gl79re-0.png)

![image-20230704101259416](../../.gitbook/assets/gr4oir-0.png)

![image-20230704101412329](../../.gitbook/assets/grtujf-0.png)

![image-20230704102107693](../../.gitbook/assets/gvxr6g-0.png)

![image-20230704102141145](../../.gitbook/assets/gw4x2o-0.png)

![image-20230704110015836](../../.gitbook/assets/ij195j-0.png)

```bash
# 写完配置文件后不会立即生效
exportfs -r  # 生效配置
exportfs -au # 停止所有服务
exportsfs -v # 查看共享服务
```

![image-20230704110432230](../../.gitbook/assets/ikd164-0.png)

![image-20230704112100094](../../.gitbook/assets/ijijk2-0.png)

```bash
# 在客户端查看共享目录
showmount -e IP
```

![image-20230704113634047](../../.gitbook/assets/isljuv-0.png)

![image-20230704150650687](../../.gitbook/assets/ox94jp-0.png)

> 当你知道NFS服务器的IP后，如果想临时访问，可以直接访问`/net/IP`，就可以直接临时访问NFS共享文件

## 4.inotify

![image-20230704151831216](../../.gitbook/assets/p42ecj-0.png)

![image-20230704152916303](../../.gitbook/assets/pai73f-0.png)

![image-20230704153009004](../../.gitbook/assets/pazo3g-0.png)

![image-20230704153206126](../../.gitbook/assets/pc5zo8-0.png)

![image-20230704153856137](../../.gitbook/assets/pga9ge-0.png)

![image-20230704155203495](../../.gitbook/assets/po4cc0-0.png)

![image-20230704155546035](../../.gitbook/assets/pq4v9s-0.png)

## 5.rsync

![image-20230704160421892](../../.gitbook/assets/qj6xbk-0.png)

![image-20230704160620156](../../.gitbook/assets/qkayqn-0.png)

## 5.inotify+rsync

```bash
##!/bin/bash
SRC='/data'
DEST='rsyncuer@192.168.19.136::backup'
inotifywait -mrq --timefmt '%Y-%m-%d %H:%M' --format '$T %w %f' -e create,delete,moved_to,close_write,attrib ${SRC} | while read DATE TIME DIR FILE;do
        FILEPATH=${DIR}${FILE}
        rsync -az --delete --password-file=/etc/rsync.pass $SRC $DEST && echo "At ${TIME} on ${DATE},file $FILEPATH was backuped up via rsync" >> /var/log/changelist.log
done
```
