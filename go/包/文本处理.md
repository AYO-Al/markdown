# 1 stringsåŒ…

## 1.1 å­—ç¬¦ä¸²æ¯”è¾ƒ

```go
package main  
  
import (  
    "fmt"  
    "strings")  
  
func main() {  
    a := "a"  
    b := "A"  
    /*
    Compare å‡½æ•°ï¼Œç”¨äºæ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²çš„å¤§å°ï¼Œå¦‚æœä¸¤ä¸ªå­—ç¬¦ä¸²ç›¸ç­‰ï¼Œè¿”å›ä¸º 0ã€‚å¦‚æœ a å°äº b ï¼Œè¿”å› -1 ï¼Œåä¹‹è¿”å› 1 ã€‚ä¸æ¨èä½¿ç”¨è¿™ä¸ªå‡½æ•°ï¼Œç›´æ¥ä½¿ç”¨ == != > < >= <= ç­‰ä¸€ç³»åˆ—è¿ç®—ç¬¦æ›´åŠ ç›´è§‚ã€‚
    */
    fmt.Println(strings.Compare(a, b))  // åŒºåˆ†å¤§å°  
    fmt.Println(strings.EqualFold(a, b)) // ä¸åŒºåˆ†å¤§å°  
}

/*
1
true
*/
```
## 1.2 æ˜¯å¦å­˜åœ¨æŸä¸ªå­—ç¬¦

æœ‰å¥½å‡ ä¸ªå‡½æ•°å¯ä»¥è¿›è¡Œåˆ¤æ–­ã€‚
```go
// å­ä¸² substr åœ¨ s ä¸­ï¼Œè¿”å› true
func Contains(s, substr string) bool

// chars ä¸­ä»»ä½•ä¸€ä¸ª Unicode ä»£ç ç‚¹åœ¨ s ä¸­ï¼Œè¿”å› true
func ContainsAny(s, chars string) bool

// Unicode ä»£ç ç‚¹ r åœ¨ s ä¸­ï¼Œè¿”å› true
func ContainsRune(s string, r rune) bool

// è¿”å›å­å­—ç¬¦ä¸²åœ¨å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œä¸å­˜åœ¨åˆ™è¿”å› -1ã€‚
func Index(s, substr string) int 

// IndexAny è¿”å› s ä¸­å­—ç¬¦çš„ä»»ä½• Unicode ä»£ç ç‚¹çš„ç¬¬ä¸€ä¸ªå®ä¾‹çš„ç´¢å¼•ï¼Œå¦‚æœ s ä¸­ä¸å­˜åœ¨å­—ç¬¦çš„ Unicode ä»£ç ç‚¹ï¼Œåˆ™è¿”å› -1ã€‚
func IndexAny(s, chars string) int

// è¿”å›runeä¸­åœ¨sä¸­çš„ä½ç½®ï¼Œå¦åˆ™è¿”å›-1
func IndexRune(s string, r rune) int

// å¸¦Lastå‰ç¼€çš„å‡½æ•°è¿”å›æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®
```

çœ‹ä¸‹è¿è¡Œè¿™äº›å‡½æ•°è¿”å›çš„ç»“æœã€‚
```go
func main() {
	s := "yes"
	fmt.Println(strings.Contains(s, "ye"))
	fmt.Println(strings.ContainsAny(s, "y e"))
	fmt.Println(strings.ContainsRune(s, 'y'))
	fmt.Println(strings.Index(s, "ye"))
	fmt.Println(strings.IndexAny(s, "ye"))
	fmt.Println(strings.IndexRune(s, 'e'))
}

/*
true
true
true
0
0
1
*/
```

å…¶å®æŸ¥çœ‹å‰é¢ä¸‰ä¸ªå‡½æ•°çš„æºä»£ç å°±ä¼šå‘ç°å…¶å®è°ƒç”¨çš„éƒ½æ˜¯ç›¸å¯¹åº”ç±»å‹`Index`å‡½æ•°ã€‚
```go
  
// Contains reports whether substr is within s.
func Contains(s, substr string) bool {
	return Index(s, substr) >= 0
}

// ContainsAny reports whether any Unicode code points in chars are within s.
func ContainsAny(s, chars string) bool {
	return IndexAny(s, chars) >= 0
}

// ContainsRune reports whether the Unicode code point r is within s.
func ContainsRune(s string, r rune) bool {
	return IndexRune(s, r) >= 0
}
```
## 1.3 å­ä¸²å‡ºç°çš„æ¬¡æ•°

goä¸­è®¡ç®—å­ä¸²åœ¨å­—ç¬¦ä¸²ä¸­å‡ºç°æ¬¡æ•°çš„å‡½æ•°æ˜¯`Count`ã€‚
```go

func main() {
	s := "chesesese"
	fmt.Println(strings.Count(s, "ese")) // 2
}
```

ç‰¹åˆ«è¦æ³¨æ„çš„æ˜¯Countè¿”å›çš„æ˜¯åœ¨å­—ç¬¦ä¸²ä¸­æ— é‡å çš„æ¬¡æ•°ï¼Œæ‰€ä»¥è¿™é‡Œè¿”å›çš„æ˜¯2.å½“substrä¸ºç©ºçš„æ—¶å€™è¿”å›çš„æ˜¯`utf8.RuneCountInString(s) + 1`
## 1.4 å­—ç¬¦ä¸²åˆ†å‰²

å­—ç¬¦ä¸²åˆ†å‰²æœ€å¸¸ç”¨çš„å°±æ˜¯`Split`ç³»åˆ—å‡½æ•°ã€‚
```go
func Split(s, sep string) []string { return genSplit(s, sep, 0, -1) }
func SplitAfter(s, sep string) []string { return genSplit(s, sep, len(sep), -1) }
func SplitN(s, sep string, n int) []string { return genSplit(s, sep, 0, n) }
func SplitAfterN(s, sep string, n int) []string { return genSplit(s, sep, len(sep), n) }
```

å¯ä»¥çœ‹åˆ°è¿™å››ä¸ªå‡½æ•°éƒ½è°ƒç”¨äº†`genSplit`å‡½æ•°ã€‚

è¿™å››ä¸ªå‡½æ•°éƒ½æ˜¯é€šè¿‡ sep è¿›è¡Œåˆ†å‰²ï¼Œè¿”å›\[\]stringã€‚å¦‚æœ sep ä¸ºç©ºï¼Œç›¸å½“äºåˆ†æˆä¸€ä¸ªä¸ªçš„ UTF-8 å­—ç¬¦ï¼Œå¦‚Â `Split("abc","")`ï¼Œå¾—åˆ°çš„æ˜¯\[a b c\]ã€‚

Split(s, sep) å’Œ SplitN(s, sep, -1) ç­‰ä»·ï¼›SplitAfter(s, sep) å’Œ SplitAfterN(s, sep, -1) ç­‰ä»·ã€‚å¸¦`After`çš„å‡½æ•°ä¼šæŠŠåˆ†éš”ç¬¦ä¿ç•™ä¸‹æ¥ã€‚

å¸¦ N çš„æ–¹æ³•å¯ä»¥é€šè¿‡æœ€åä¸€ä¸ªå‚æ•° n æ§åˆ¶è¿”å›çš„ç»“æœä¸­çš„ slice ä¸­çš„å…ƒç´ ä¸ªæ•°ï¼Œå½“ n < 0 æ—¶ï¼Œè¿”å›æ‰€æœ‰çš„å­å­—ç¬¦ä¸²ï¼›å½“ n == 0 æ—¶ï¼Œè¿”å›çš„ç»“æœæ˜¯ nilï¼›å½“ n > 0 æ—¶ï¼Œè¡¨ç¤ºè¿”å›çš„ slice ä¸­æœ€å¤šåªæœ‰ n ä¸ªå…ƒç´ ï¼Œå…¶ä¸­ï¼Œæœ€åä¸€ä¸ªå…ƒç´ ä¸ä¼šåˆ†å‰²ï¼Œæ¯”å¦‚ï¼š
```go
func main() {  
    s := "I,love,you,as,who,you,are"  
    fmt.Println(strings.Split(s, ","))  
    fmt.Println(strings.SplitN(s, ",", 2))  
    fmt.Println(strings.SplitAfter(s, ","))  
    fmt.Println(strings.SplitAfterN(s, ",", 2))  
}

/*
[I love you as who you are]
[I love,you,as,who,you,are]
[I, love, you, as, who, you, are]
[I, love,you,as,who,you,are]
*/
```
## 1.5 åˆ¤æ–­å­—ç¬¦ä¸²å‰ç¼€æˆ–åç¼€

```go
// s ä¸­æ˜¯å¦ä»¥ prefix å¼€å§‹
func HasPrefix(s, prefix string) bool {
  return len(s) >= len(prefix) && s[0:len(prefix)] == prefix
}
// s ä¸­æ˜¯å¦ä»¥ suffix ç»“å°¾
func HasSuffix(s, suffix string) bool {
  return len(s) >= len(suffix) && s[len(s)-len(suffix):] == suffix
}
```

å¦‚æœ prefix æˆ– suffix ä¸º "" , è¿”å›å€¼æ€»æ˜¯ trueã€‚
## 1.6 Joinæ“ä½œ

å¯ä»¥å°†å­—ç¬¦ä¸²åˆ‡ç‰‡è·³è¿‡sepåˆ†éš”ç¬¦è¿æ¥èµ·æ¥ã€‚
```go
func Join(a []string, sep string) string
```
## 1.7 æ„å»ºé‡å¤å­—ç¬¦

å‡½æ•°ç­¾åå¦‚ä¸‹ï¼š

```
func Repeat(s string, count int) string
```

å°† s é‡å¤ count æ¬¡ï¼Œå¦‚æœ count ä¸ºè´Ÿæ•°æˆ–è¿”å›å€¼é•¿åº¦ len(s)*count è¶…å‡º string ä¸Šé™ä¼šå¯¼è‡´ panicï¼Œè¿™ä¸ªå‡½æ•°ä½¿ç”¨å¾ˆç®€å•ï¼š

```
fmt.Println("ba" + strings.Repeat("na", 2))
```

è¾“å‡ºç»“æœï¼š

```
banana
```
## 1.8 å­—ç¬¦æ›¿æ¢

å¯ä»¥ä½¿ç”¨`Map`æˆ–`Replace`å¯¹å­—ç¬¦è¿›è¡Œæ›¿æ¢ï¼Œä½†è¿™ä¸¤ä¸ªæ–¹æ³•ç²’åº¦ä¸åŒã€‚
```go
func Map(mapping func(rune) rune, s string) string

// å¦‚æœ n < 0ï¼Œåˆ™ä¸é™åˆ¶æ›¿æ¢æ¬¡æ•°ï¼Œå³å…¨éƒ¨æ›¿æ¢
func Replace(s, old, new string, n int) string
// è¯¥å‡½æ•°å†…éƒ¨ç›´æ¥è°ƒç”¨äº†å‡½æ•° Replace(s, old, new , -1)
func ReplaceAll(s, old, new string) string
```

`Map`æ–¹æ³•å¯ä»¥è®¾ç½®ä¸€ä¸ªå‡½æ•°æŒ‰ç…§å­—é¢é‡ç²’åº¦å¯¹å­—ç¬¦è¿›è¡Œæ˜ å°„æ›¿æ¢ã€‚å¦‚æœ mapping è¿”å›å€¼ <0 ï¼Œåˆ™èˆå¼ƒè¯¥å­—ç¬¦ã€‚è¯¥æ–¹æ³•åªèƒ½å¯¹æ¯ä¸€ä¸ªå­—ç¬¦åšå¤„ç†ï¼Œä½†å¤„ç†æ–¹å¼å¾ˆçµæ´»ï¼Œå¯ä»¥æ–¹ä¾¿çš„è¿‡æ»¤ï¼Œç­›é€‰æ±‰å­—ç­‰ã€‚
```go
var mapping = func(r rune) rune {  
    switch {  
    case r >= 'A' && r <= 'Z':  
       return r + 32  
    case r >= 'a' && r <= 'z':  
       return r  
    }  
    return -1  
}  
  
func main() {  
    s := "yeyeyeyeeyAAAAAA"  
    fmt.Println(strings.Map(mapping, s))   // yeyeyeyeeyaaaaaa
}
```

`Replace`å‡½æ•°å¯ä»¥ç›´æ¥æ›¿æ¢å­—ç¬¦ä¸²ä¸­çš„å­ä¸²ã€‚
```go
func main() {  
    s := "yeyeyeyeeyAAAAAA"  
    fmt.Println(strings.Replace(s, "A", "T", -1))  // yeyeyeyeeyTTTTTT
}
```

`Replce`æ–¹æ³•åªèƒ½å¯¹å•ä¸ªå­ä¸²è¿›è¡Œæ›¿æ¢ï¼Œå¦‚æœæƒ³è¿›è¡Œå¤šå­ä¸²æ›¿æ¢ï¼Œå¯ä»¥å®šä¹‰ä¸€ä¸ª`Replacer`å¯¹è±¡ã€‚
```go

func main() {
	// NewReplacer panics if given an odd number of arguments.
	r := strings.NewReplacer("y", "Y", "s", "S") // å‚æ•°ä¸ºä¸€ä¸ªold->newæ˜ å°„åˆ—è¡¨
	fmt.Println(r.Replace("ysysy"))
	b := &bytes.Buffer{}
	r.WriteString(b, "ysysysysys") // æ›¿æ¢åçš„å­—ç¬¦å†™å…¥io.Writer
	fmt.Println(b)
}
/*
YSYSY
YSYSYSYSYS
*/
```

## 1.9 å¤§å°å†™è½¬æ¢

åœ¨stringsåŒ…ä¸­æä¾›äº†å››ç§å¤§å°å†™è½¬æ¢çš„å‡½æ•°ã€‚
```go
func ToLower(s string) string
func ToLowerSpecial(c unicode.SpecialCase, s string) string
func ToUpper(s string) string
func ToUpperSpecial(c unicode.SpecialCase, s string) string
```

è¿™å››ç§å‡½æ•°éƒ½ç”¨æ¥æŠŠå­—ç¬¦ä¸²å…¨éƒ¨è½¬æ¢æˆå¤§å°æˆ–å°å†™ã€‚ä½†`ToLowerSpecial`å’Œ`ToUpperSpecial`å¯ä»¥è½¬æ¢ç‰¹æ®Šå­—ç¬¦çš„å¤§å°å†™ã€‚
```go
func main() {
    // è‡ªå®šä¹‰å¤§å°å†™æ˜ å°„è§„åˆ™
    specialCase := unicode.SpecialCase{
        unicode.CaseRange{
            Lo: 0x41, // 'A'
            Hi: 0x5A, // 'Z'
            Delta: [unicode.MaxCase]rune{32, 0, 0}, // å°†å¤§å†™å­—æ¯è½¬æ¢ä¸ºå°å†™
        },
        unicode.CaseRange{
            Lo: 0x61, // 'a'
            Hi: 0x7A, // 'z'
            Delta: [unicode.MaxCase]rune{-32, 0, 0}, // å°†å°å†™å­—æ¯è½¬æ¢ä¸ºå¤§å†™
        },
    }

    fmt.Println(strings.ToLowerSpecial(specialCase, "HELLO, WORLD")) // "hello, world"
    fmt.Println(strings.ToLowerSpecial(specialCase, "hello, world")) // "HELLO, WORLD"
}
```
## 1.10 ä¿®å‰ªå­—ç¬¦ä¸²

```go
// å°† s å·¦ä¾§å’Œå³ä¾§ä¸­åŒ¹é… cutset ä¸­çš„ä»»ä¸€å­—ç¬¦çš„å­—ç¬¦å»æ‰
func Trim(s string, cutset string) string
// å°† s å·¦ä¾§çš„åŒ¹é… cutset ä¸­çš„ä»»ä¸€å­—ç¬¦çš„å­—ç¬¦å»æ‰
func TrimLeft(s string, cutset string) string
// å°† s å³ä¾§çš„åŒ¹é… cutset ä¸­çš„ä»»ä¸€å­—ç¬¦çš„å­—ç¬¦å»æ‰
func TrimRight(s string, cutset string) string
// å¦‚æœ s çš„å‰ç¼€ä¸º prefix åˆ™è¿”å›å»æ‰å‰ç¼€åçš„ string , å¦åˆ™ s æ²¡æœ‰å˜åŒ–ã€‚
func TrimPrefix(s, prefix string) string
// å¦‚æœ s çš„åç¼€ä¸º suffix åˆ™è¿”å›å»æ‰åç¼€åçš„ string , å¦åˆ™ s æ²¡æœ‰å˜åŒ–ã€‚
func TrimSuffix(s, suffix string) string
// å°† s å·¦ä¾§å’Œå³ä¾§çš„é—´éš”ç¬¦å»æ‰ã€‚å¸¸è§é—´éš”ç¬¦åŒ…æ‹¬ï¼š'\t', '\n', '\v', '\f', '\r', ' ', U+0085 (NEL)
func TrimSpace(s string) string
// å°† s å·¦ä¾§å’Œå³ä¾§çš„åŒ¹é… f çš„å­—ç¬¦å»æ‰
func TrimFunc(s string, f func(rune) bool) string
// å°† s å·¦ä¾§çš„åŒ¹é… f çš„å­—ç¬¦å»æ‰
func TrimLeftFunc(s string, f func(rune) bool) string
// å°† s å³ä¾§çš„åŒ¹é… f çš„å­—ç¬¦å»æ‰
func TrimRightFunc(s string, f func(rune) bool) string
```

ç¤ºä¾‹ï¼š
```go
x := "!!!@@@ä½ å¥½,!@#$ Gophers###$$$"
fmt.Println(strings.Trim(x, "@#$!%^&*()_+=-"))
fmt.Println(strings.TrimLeft(x, "@#$!%^&*()_+=-"))
fmt.Println(strings.TrimRight(x, "@#$!%^&*()_+=-"))
fmt.Println(strings.TrimSpace(" \t\n Hello, Gophers \n\t\r\n"))
fmt.Println(strings.TrimPrefix(x, "!"))
fmt.Println(strings.TrimSuffix(x, "$"))

f := func(r rune) bool {
    return !unicode.Is(unicode.Han, r) // éæ±‰å­—è¿”å› true
}
fmt.Println(strings.TrimFunc(x, f))
fmt.Println(strings.TrimLeftFunc(x, f))
fmt.Println(strings.TrimRightFunc(x, f))

/*
ä½ å¥½,!@#$ Gophers
ä½ å¥½,!@#$ Gophers###$$$
!!!@@@ä½ å¥½,!@#$ Gophers
Hello, Gophers
!!@@@ä½ å¥½,!@#$ Gophers###$$$
!!!@@@ä½ å¥½,!@#$ Gophers###$$
ä½ å¥½
ä½ å¥½,!@#$ Gophers###$$$
!!!@@@ä½ å¥½
*/
```
## 1.11 Builder ç±»å‹

è¯¥ç±»å‹å®ç°äº† io åŒ…ä¸‹çš„ Writer, ByteWriter, StringWriter ç­‰æ¥å£ï¼Œå¯ä»¥å‘è¯¥å¯¹è±¡å†…å†™å…¥æ•°æ®ï¼ŒBuilder æ²¡æœ‰å®ç° Reader ç­‰æ¥å£ï¼Œæ‰€ä»¥è¯¥ç±»å‹ä¸å¯è¯»ï¼Œä½†æä¾›äº† String æ–¹æ³•å¯ä»¥è·å–å¯¹è±¡å†…çš„æ•°æ®ã€‚
```go
// è¯¥æ–¹æ³•å‘ b å†™å…¥ä¸€ä¸ªå­—èŠ‚
func (b *Builder) WriteByte(c byte) error
// WriteRune æ–¹æ³•å‘ b å†™å…¥ä¸€ä¸ªå­—ç¬¦
func (b *Builder) WriteRune(r rune) (int, error)
// WriteRune æ–¹æ³•å‘ b å†™å…¥å­—èŠ‚æ•°ç»„ p
func (b *Builder) Write(p []byte) (int, error)
// WriteRune æ–¹æ³•å‘ b å†™å…¥å­—ç¬¦ä¸² s
func (b *Builder) WriteString(s string) (int, error)
// Len æ–¹æ³•è¿”å› b çš„æ•°æ®é•¿åº¦ã€‚
func (b *Builder) Len() int
// Cap æ–¹æ³•è¿”å› b çš„ capã€‚
func (b *Builder) Cap() int
// Grow æ–¹æ³•å°† b çš„ cap è‡³å°‘å¢åŠ  n (å¯èƒ½ä¼šæ›´å¤š)ã€‚å¦‚æœ n ä¸ºè´Ÿæ•°ï¼Œä¼šå¯¼è‡´ panicã€‚
func (b *Builder) Grow(n int)
// Reset æ–¹æ³•å°† b æ¸…ç©º b çš„æ‰€æœ‰å†…å®¹ã€‚
func (b *Builder) Reset()
// String æ–¹æ³•å°† b çš„æ•°æ®ä»¥ string ç±»å‹è¿”å›ã€‚
func (b *Builder) String() string
```

Builder çš„ cap ä¼šè‡ªåŠ¨å¢é•¿ï¼Œä¸€èˆ¬ä¸éœ€è¦æ‰‹åŠ¨è°ƒç”¨ Grow æ–¹æ³•ã€‚

String æ–¹æ³•å¯ä»¥æ–¹ä¾¿çš„è·å– Builder çš„å†…å®¹ã€‚å¯ä»¥ç”¨æ¥æ‹¼æ¥å­—ç¬¦ä¸²ã€‚
```go
b := strings.Builder{}
_ = b.WriteByte('7')
n, _ := b.WriteRune('å¤•')
fmt.Println(n)
n, _ = b.Write([]byte("Hello, World"))
fmt.Println(n)
n, _ = b.WriteString("ä½ å¥½ï¼Œä¸–ç•Œ")
fmt.Println(n)
fmt.Println(b.Len())
fmt.Println(b.Cap())
b.Grow(100)
fmt.Println(b.Len())
fmt.Println(b.Cap())
fmt.Println(b.String())
b.Reset()
fmt.Println(b.String())

/*
3
12
15
31
32
31
164
7å¤•Hello, Worldä½ å¥½ï¼Œä¸–ç•Œ
*/
```
## 1.12 å­—ç¬¦ä¸²åˆ‡ç‰‡

åœ¨Goä¸­å­—ç¬¦ä¸²çš„åº•å±‚å…¶å®å°±æ˜¯ä¸€ä¸ª\[\]byteï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥ä½¿ç”¨åˆ‡ç‰‡çš„æ–¹æ³•è·å–å­ä¸²ã€‚
```go
/*
s[start:end(exclusive)]
*/

func main() {  
    s := "abcdefgh"  
    fmt.Println(s[:4])   //çœç•¥ä»£è¡¨ä»å¤´å¼€å§‹
}
```
# 2 bytesåŒ…

è¯¥åŒ…å®šä¹‰äº†ä¸€äº›æ“ä½œ byte slice çš„ä¾¿åˆ©æ“ä½œã€‚å› ä¸ºå­—ç¬¦ä¸²å¯ä»¥è¡¨ç¤ºä¸º []byteï¼Œå› æ­¤ï¼Œbytes åŒ…å®šä¹‰çš„å‡½æ•°ã€æ–¹æ³•ç­‰å’Œ strings åŒ…å¾ˆç±»ä¼¼ã€‚
## 2.1 Runeç±»å‹è½¬æ¢

```go
// å°† []byte è½¬æ¢ä¸º []rune
func Runes(s []byte) []rune
```

è¯¥å‡½æ•°å°† []byte è½¬æ¢ä¸º []rune ï¼Œé€‚ç”¨äºæ±‰å­—ç­‰å¤šå­—èŠ‚å­—ç¬¦ï¼Œç¤ºä¾‹ï¼š

```go
b:=[]byte("ä½ å¥½ï¼Œä¸–ç•Œ")
for k,v:=range b{
    fmt.Printf("%d:%s |",k,string(v))
}
r:=bytes.Runes(b)
for k,v:=range r{
    fmt.Printf("%d:%s|",k,string(v))
}
```

è¿è¡Œç»“æœï¼š

```
0:Ã¤ |1:Â½ |2:  |3:Ã¥ |4:Â¥ |5:Â½ |6:Ã¯ |7:Â¼ |8:  |9:Ã¤ |10:Â¸ |11:  |12:Ã§ |13:  |14: |
0:ä½ |1:å¥½|2:ï¼Œ|3:ä¸–|4:ç•Œ|
```
## 2.2 Bufferç±»å‹

```go
type Buffer struct {
    buf      []byte
    off      int   
    lastRead readOp 
}
```

bytes.Buffer ç±»å‹ï¼Œè¯¥ç±»å‹å®ç°äº† io åŒ…ä¸‹çš„ ByteScanner, ByteWriter, ReadWriter, Reader, ReaderFrom, RuneReader, RuneScanner, StringWriter, Writer, WriterTo ç­‰æ¥å£ï¼Œå¯ä»¥æ–¹ä¾¿çš„è¿›è¡Œè¯»å†™æ“ä½œã€‚

Buffer å¯ä»¥é€šè¿‡ 3 ä¸­æ–¹æ³•åˆå§‹åŒ–å¯¹è±¡ï¼š

```go
a := bytes.NewBufferString("Hello World")
b := bytes.NewBuffer([]byte("Hello World"))
c := bytes.Buffer{}

fmt.Println(a)
fmt.Println(b)
fmt.Println(c)
}
```

```go
// è¯»å–åˆ°å­—èŠ‚ delim åï¼Œä»¥å­—èŠ‚æ•°ç»„çš„å½¢å¼è¿”å›è¯¥å­—èŠ‚åŠå‰é¢è¯»å–åˆ°çš„å­—èŠ‚ã€‚å¦‚æœéå† b.buf ä¹Ÿæ‰¾ä¸åˆ°åŒ¹é…çš„å­—èŠ‚ï¼Œåˆ™è¿”å›é”™è¯¯(ä¸€èˆ¬æ˜¯ EOF)
func (b *Buffer) ReadBytes(delim byte) (line []byte, err error)
// è¯»å–åˆ°å­—èŠ‚ delim åï¼Œä»¥å­—ç¬¦ä¸²çš„å½¢å¼è¿”å›è¯¥å­—èŠ‚åŠå‰é¢è¯»å–åˆ°çš„å­—èŠ‚ã€‚å¦‚æœéå† b.buf ä¹Ÿæ‰¾ä¸åˆ°åŒ¹é…çš„å­—èŠ‚ï¼Œåˆ™è¿”å›é”™è¯¯(ä¸€èˆ¬æ˜¯ EOF)
func (b *Buffer) ReadString(delim byte) (line string, err error)
// æˆªæ–­ b.buf , èˆå¼ƒ b.off+n ä¹‹åçš„æ•°æ®ã€‚n == 0 æ—¶ï¼Œè°ƒç”¨ Reset æ–¹æ³•é‡ç½®è¯¥å¯¹è±¡ï¼Œå½“ n è¶Šç•Œæ—¶ï¼ˆn < 0 || n > b.Len() ï¼‰æ–¹æ³•ä¼šè§¦å‘ panic.
func (b *Buffer) Truncate(n int)
```

```go
a := bytes.NewBufferString("Good Night")

x, err := a.ReadBytes('t')
if err != nil {
    fmt.Println("delim:t err:", err)
} else {
    fmt.Println(string(x))
}

a.Truncate(0)
a.WriteString("Good Night")
fmt.Println(a.Len())
a.Truncate(5)
fmt.Println(a.Len())
y, err := a.ReadString('N')
if err != nil {
    fmt.Println("delim:N err:", err)
} else {
    fmt.Println(y)
}

/*
Good Night
10
5
delim:N err: EOF
*/
```
# 3 strconvï¼šå­—ç¬¦ä¸²ä¸åŸºæœ¬ç±»å‹è½¬æ¢

ç”±äºå°†å­—ç¬¦ä¸²è½¬ä¸ºå…¶ä»–æ•°æ®ç±»å‹å¯èƒ½ä¼šå‡ºé”™ï¼Œ_strconv_Â åŒ…å®šä¹‰äº†ä¸¤ä¸ªÂ _error_Â ç±»å‹çš„å˜é‡ï¼š_ErrRange_Â å’ŒÂ _ErrSyntax_ã€‚å…¶ä¸­ï¼Œ_ErrRange_Â è¡¨ç¤ºå€¼è¶…è¿‡äº†ç±»å‹èƒ½è¡¨ç¤ºçš„æœ€å¤§èŒƒå›´ï¼Œæ¯”å¦‚å°† "128" è½¬ä¸º int8 å°±ä¼šè¿”å›è¿™ä¸ªé”™è¯¯ï¼›_ErrSyntax_Â è¡¨ç¤ºè¯­æ³•é”™è¯¯ï¼Œæ¯”å¦‚å°† "" è½¬ä¸º int ç±»å‹ä¼šè¿”å›è¿™ä¸ªé”™è¯¯ã€‚

ç„¶è€Œï¼Œåœ¨è¿”å›é”™è¯¯çš„æ—¶å€™ï¼Œä¸æ˜¯ç›´æ¥å°†ä¸Šé¢çš„å˜é‡å€¼è¿”å›ï¼Œè€Œæ˜¯é€šè¿‡æ„é€ ä¸€ä¸ªÂ _NumError_Â ç±»å‹çš„Â _error_Â å¯¹è±¡è¿”å›ã€‚_NumError_Â ç»“æ„çš„å®šä¹‰å¦‚ä¸‹ï¼š

```go
// A NumError records a failed conversion.
type NumError struct {
    Func string // the failing function (ParseBool, ParseInt, ParseUint, ParseFloat)
    Num  string // the input
    Err  error  // the reason the conversion failed (ErrRange, ErrSyntax)
}
```

å¯è§ï¼Œè¯¥ç»“æ„è®°å½•äº†è½¬æ¢è¿‡ç¨‹ä¸­å‘ç”Ÿçš„é”™è¯¯ä¿¡æ¯ã€‚è¯¥ç»“æ„ä¸ä»…åŒ…å«äº†ä¸€ä¸ªÂ _error_Â ç±»å‹çš„æˆå‘˜ï¼Œè®°å½•å…·ä½“çš„é”™è¯¯ä¿¡æ¯ï¼Œè€Œä¸”å®ƒè‡ªå·±ä¹Ÿå®ç°äº†Â _error_Â æ¥å£ï¼š

```go
func (e *NumError) Error() string {
    return "strconv." + e.Func + ": " + "parsing " + Quote(e.Num) + ": " + e.Err.Error()
}
```

åŒ…çš„å®ç°ä¸­ï¼Œå®šä¹‰äº†ä¸¤ä¸ªä¾¿æ·å‡½æ•°ï¼Œç”¨äºæ„é€ Â _NumError_Â å¯¹è±¡ï¼š

```go
func syntaxError(fn, str string) *NumError {
    return &NumError{fn, str, ErrSyntax}
}

func rangeError(fn, str string) *NumError {
    return &NumError{fn, str, ErrRange}
}
```
## 3.1 å­—ç¬¦ä¸²å’Œæ•´å‹ä¹‹é—´çš„è½¬æ¢

æœ€å¸¸ç”¨çš„æœ‰ä¸‰ä¸ªå‡½æ•°ã€‚
```go
func ParseInt(s string, base int, bitSize int) (i int64, err error)
func ParseUint(s string, base int, bitSize int) (n uint64, err error)
func Atoi(s string) (i int, err error)
```

å…¶ä¸­ï¼ŒAtoi æ˜¯ ParseInt çš„ä¾¿æ·ç‰ˆï¼Œå†…éƒ¨é€šè¿‡è°ƒç”¨Â _ParseInt(s, 10, 0)_Â æ¥å®ç°çš„ï¼›ParseInt è½¬ä¸ºæœ‰ç¬¦å·æ•´å‹ï¼›ParseUint è½¬ä¸ºæ— ç¬¦å·æ•´å‹ã€‚

å‚æ•°Â _base_Â ä»£è¡¨å­—ç¬¦ä¸²æŒ‰ç…§ç»™å®šçš„è¿›åˆ¶è¿›è¡Œè§£é‡Šã€‚ä¸€èˆ¬çš„ï¼Œbase çš„å–å€¼ä¸º 2~36ï¼Œå¦‚æœ base çš„å€¼ä¸º 0ï¼Œåˆ™ä¼šæ ¹æ®å­—ç¬¦ä¸²çš„å‰ç¼€æ¥ç¡®å®š base çš„å€¼ï¼š"0x" è¡¨ç¤º 16 è¿›åˆ¶ï¼› "0" è¡¨ç¤º 8 è¿›åˆ¶ï¼›å¦åˆ™å°±æ˜¯ 10 è¿›åˆ¶ã€‚

å‚æ•°Â _bitSize_Â è¡¨ç¤ºçš„æ˜¯æ•´æ•°å–å€¼èŒƒå›´ï¼Œæˆ–è€…è¯´æ•´æ•°çš„å…·ä½“ç±»å‹ã€‚å–å€¼ 0ã€8ã€16ã€32 å’Œ 64 åˆ†åˆ«ä»£è¡¨ intã€int8ã€int16ã€int32 å’Œ int64ã€‚

è¿™é‡Œæœ‰å¿…è¦è¯´ä¸€ä¸‹ï¼Œå½“ bitSize\==0 æ—¶çš„æƒ…å†µã€‚

Go ä¸­ï¼Œint/uint ç±»å‹ï¼Œä¸åŒç³»ç»Ÿèƒ½è¡¨ç¤ºçš„èŒƒå›´æ˜¯ä¸ä¸€æ ·çš„ï¼Œç›®å‰çš„å®ç°æ˜¯ï¼Œ32 ä½ç³»ç»Ÿå  4 ä¸ªå­—èŠ‚ï¼›64 ä½ç³»ç»Ÿå  8 ä¸ªå­—èŠ‚ã€‚å½“ bitSize\==0 æ—¶ï¼Œåº”è¯¥è¡¨ç¤º 32 ä½è¿˜æ˜¯ 64 ä½å‘¢ï¼Ÿè¿™é‡Œæ²¡æœ‰åˆ©ç”¨Â _runtime.GOARCH_Â ä¹‹ç±»çš„æ–¹å¼ï¼Œè€Œæ˜¯å·§å¦™çš„é€šè¿‡å¦‚ä¸‹è¡¨è¾¾å¼ç¡®å®š intSizeï¼š

```
const intSize = 32 << uint(^uint(0)>>63)
const IntSize = intSize // number of bits in int, uint (32 or 64)
```

```go
package main  
  
import (  
    "fmt"  
    "strconv")  
  
func main() {  
    s := "128"  
    n, err := strconv.ParseInt(s, 10, 8)  // å¦‚æœä½æ•°å®¹çº³ä¸äº†ï¼Œä¼šè¿”å›æœ€å¤§çš„å€¼ï¼Œn=127
    if err != nil {  
       fmt.Println(err)  
    }  
    fmt.Printf("%T\t%v\n", n, n)  
    p, err := strconv.ParseUint(s, 10, 8)  
    fmt.Printf("%T\t%v\n", p, p)  
    m, err := strconv.Atoi(s)  
    fmt.Printf("%T\t%v\n", m, m)  
}

/*
strconv.ParseInt: parsing "128": value out of range
int64   127
uint64  128
int     128
*/
```
## 3.2 æ•´å‹è½¬æ¢ä¸ºå­—ç¬¦ä¸²

å®é™…åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°éœ€è¦å°†å­—ç¬¦ä¸²å’Œæ•´å‹è¿æ¥èµ·æ¥ï¼Œåœ¨ Java ä¸­ï¼Œå¯ä»¥é€šè¿‡æ“ä½œç¬¦ "+" åšåˆ°ã€‚ä¸è¿‡ï¼Œåœ¨ Go è¯­è¨€ä¸­ï¼Œä½ éœ€è¦å°†æ•´å‹è½¬ä¸ºå­—ç¬¦ä¸²ç±»å‹ï¼Œç„¶åæ‰èƒ½è¿›è¡Œè¿æ¥ã€‚è¿™ä¸ªæ—¶å€™ï¼Œ_strconv_Â åŒ…ä¸­çš„æ•´å‹è½¬å­—ç¬¦ä¸²çš„ç›¸å…³å‡½æ•°å°±æ´¾ä¸Šç”¨åœºäº†ã€‚è¿™äº›å‡½æ•°ç­¾åå¦‚ä¸‹ï¼š

```go
func FormatUint(i uint64, base int) string    // æ— ç¬¦å·æ•´å‹è½¬å­—ç¬¦ä¸²
func FormatInt(i int64, base int) string    // æœ‰ç¬¦å·æ•´å‹è½¬å­—ç¬¦ä¸²
func Itoa(i int) string
```

å…¶ä¸­ï¼Œ_Itoa_Â å†…éƒ¨ç›´æ¥è°ƒç”¨Â _FormatInt(i, 10)_Â å®ç°çš„ã€‚base å‚æ•°å¯ä»¥å– 2~36ï¼ˆ0-9ï¼Œa-zï¼‰ã€‚

æ ‡å‡†åº“è¿˜æä¾›äº†å¦å¤–ä¸¤ä¸ªå‡½æ•°ï¼š_AppendInt_Â å’ŒÂ _AppendUint_ï¼Œè¿™ä¸¤ä¸ªå‡½æ•°ä¸æ˜¯å°†æ•´æ•°è½¬ä¸ºå­—ç¬¦ä¸²ï¼Œè€Œæ˜¯å°†æ•´æ•°è½¬ä¸ºå­—ç¬¦æ•°ç»„ append åˆ°ç›®æ ‡å­—ç¬¦æ•°ç»„ä¸­ã€‚ï¼ˆæœ€ç»ˆï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡è¿”å›çš„ \[]byte å¾—åˆ°å­—ç¬¦ä¸²ï¼‰

é™¤äº†ä½¿ç”¨ä¸Šè¿°æ–¹æ³•å°†æ•´æ•°è½¬ä¸ºå­—ç¬¦ä¸²å¤–ï¼Œç»å¸¸è§åˆ°æœ‰äººä½¿ç”¨Â _fmt_Â åŒ…æ¥åšè¿™ä»¶äº‹ã€‚å¦‚ï¼š

```go
fmt.Sprintf("%d", 127)
```

é‚£ä¹ˆï¼Œè¿™ä¸¤ç§æ–¹å¼æˆ‘ä»¬è¯¥æ€ä¹ˆé€‰æ‹©å‘¢ï¼Ÿæˆ‘ä»¬ä¸»è¦æ¥è€ƒå¯Ÿä¸€ä¸‹æ€§èƒ½ã€‚

```go
startTime := time.Now()
for i := 0; i < 10000; i++ {
    fmt.Sprintf("%d", i)
}   
fmt.Println(time.Now().Sub(startTime))

startTime := time.Now()
for i := 0; i < 10000; i++ {
    strconv.Itoa(i)
}   
fmt.Println(time.Now().Sub(startTime))
```

æˆ‘ä»¬åˆ†åˆ«å¾ªç¯è½¬æ¢äº† 10000 æ¬¡ã€‚_Sprintf_Â çš„æ—¶é—´æ˜¯ 3.549761msï¼Œè€ŒÂ _Itoa_Â çš„æ—¶é—´æ˜¯ 848.208usï¼Œç›¸å·® 4 å€å¤šã€‚

_Sprintf_Â æ€§èƒ½å·®äº›å¯ä»¥é¢„è§ï¼Œå› ä¸ºå®ƒæ¥æ”¶çš„æ˜¯ interfaceï¼Œéœ€è¦è¿›è¡Œåå°„ç­‰æ“ä½œã€‚ä¸ªäººå»ºè®®ä½¿ç”¨Â _strconv_Â åŒ…ä¸­çš„æ–¹æ³•è¿›è¡Œè½¬æ¢ã€‚
## 3.3 å­—ç¬¦ä¸²ä¸å¸ƒå°”å€¼ä¹‹é—´çš„è½¬æ¢

Go ä¸­å­—ç¬¦ä¸²å’Œå¸ƒå°”å€¼ä¹‹é—´çš„è½¬æ¢æ¯”è¾ƒç®€å•ï¼Œä¸»è¦æœ‰ä¸‰ä¸ªå‡½æ•°ï¼š

```go
// æ¥å— 1, t, T, TRUE, true, True, 0, f, F, FALSE, false, False ç­‰å­—ç¬¦ä¸²ï¼›
// å…¶ä»–å½¢å¼çš„å­—ç¬¦ä¸²ä¼šè¿”å›é”™è¯¯
func ParseBool(str string) (value bool, err error)
// ç›´æ¥è¿”å› "true" æˆ– "false"
func FormatBool(b bool) string
// å°† "true" æˆ– "false" append åˆ° dst ä¸­
// è¿™é‡Œç”¨äº†ä¸€ä¸ª append å‡½æ•°å¯¹äºå­—ç¬¦ä¸²çš„ç‰¹æ®Šå½¢å¼ï¼šappend(dst, "true"...)
func AppendBool(dst []byte, b bool)
```
## 3.4 å­—ç¬¦ä¸²ä¸æµ®ç‚¹æ•°ä¹‹é—´çš„è½¬æ¢

ç±»ä¼¼çš„ï¼ŒåŒ…å«ä¸‰ä¸ªå‡½æ•°ï¼š

```go
func ParseFloat(s string, bitSize int) (f float64, err error)
func FormatFloat(f float64, fmt byte, prec, bitSize int) string
func AppendFloat(dst []byte, f float64, fmt byte, prec int, bitSize int)
```

å‡½æ•°çš„å‘½åå’Œä½œç”¨è·Ÿä¸Šé¢è®²è§£çš„å…¶ä»–ç±»å‹ä¸€è‡´ã€‚

å…³äºÂ _FormatFloat_Â çš„Â _fmt_Â å‚æ•°ï¼Œ åœ¨ç¬¬ä¸€ç« ç¬¬ä¸‰èŠ‚[æ ¼å¼åŒ– IO](https://books.studygolang.com/The-Golang-Standard-Library-by-Example/chapter01/01.3.html)Â ä¸­æœ‰è¯¦ç»†ä»‹ç»ã€‚è€ŒÂ _prec_Â è¡¨ç¤ºæœ‰æ•ˆæ•°å­—ï¼ˆå¯¹Â _fmt='b'_Â æ— æ•ˆï¼‰ï¼Œå¯¹äº 'e', 'E' å’Œ 'f'ï¼Œæœ‰æ•ˆæ•°å­—ç”¨äºå°æ•°ç‚¹ä¹‹åçš„ä½æ•°ï¼›å¯¹äº 'g' å’Œ 'G'ï¼Œåˆ™æ˜¯æ‰€æœ‰çš„æœ‰æ•ˆæ•°å­—ã€‚ä¾‹å¦‚ï¼š

```go
strconv.FormatFloat(1223.13252, 'e', 3, 32)    // ç»“æœï¼š1.223e+03
strconv.FormatFloat(1223.13252, 'g', 3, 32)    // ç»“æœï¼š1.22e+03
```

ç”±äºæµ®ç‚¹æ•°æœ‰ç²¾åº¦çš„é—®é¢˜ï¼Œç²¾åº¦ä¸ä¸€æ ·ï¼ŒParseFloat å’Œ FormatFloat å¯èƒ½è¾¾ä¸åˆ°äº’é€†çš„æ•ˆæœã€‚å¦‚ï¼š

```go
s := strconv.FormatFloat(1234.5678, 'g', 6, 64)
strconv.ParseFloat(s, 64)
```

å¦å¤–ï¼Œfmt='b' æ—¶ï¼Œå¾—åˆ°çš„å­—ç¬¦ä¸²æ˜¯æ— æ³•é€šè¿‡Â _ParseFloat_Â è¿˜åŸçš„ã€‚
## 3.5 Quote

é™¤äº†è¿™ä¸¤ç§æ–¹æ³•ï¼Œ_strconv_Â åŒ…è¿˜æä¾›äº†å‡½æ•°è¿™åšä»¶äº‹ï¼ˆQuote å‡½æ•°ï¼‰ã€‚æˆ‘ä»¬ç§° "studygolang.com" è¿™ç§ç”¨åŒå¼•å·å¼•èµ·æ¥çš„å­—ç¬¦ä¸²ä¸º Go è¯­è¨€å­—é¢å€¼å­—ç¬¦ä¸²ï¼ˆGo string literalï¼‰ã€‚

```go
fmt.Println("This is", strconv.Quote("studygolang.com"), "website")

// ç­‰ä»·äº
fmt.Println(`This is "studygolang.com" website`)
```
# 4 RegexpåŒ…


Goä¸­ä½¿ç”¨RegexpåŒ…æ¥ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ï¼Œç®€å•çš„æ­£åˆ™å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä¸¤ä¸ªå‡½æ•°ã€‚
```go
// byteåˆ‡ç‰‡
func Match(pattern string, b []byte) (matched bool, err error)

// å­—ç¬¦ä¸²ï¼Œæ­£åˆ™è¡¨è¾¾å¼é”™è¯¯æ—¶æ‰ä¼šè¿”å›é”™è¯¯
func MatchString(pattern string, s string) (matched bool, err error)
```

ç¤ºä¾‹ï¼š
```go
func main() {  
    matched, err := regexp.Match("as.*", []byte(`asdasdasd`))  
    fmt.Println(matched, err)  
    matched, err = regexp.MatchString("a(b", "ashjhj")  // æ­£åˆ™è¯­æ³•é”™è¯¯ 
    fmt.Println(matched, err)  
}

/*
true <nil>
false error parsing regexp: missing closing ): `a(b`
*/
```
## 4.1 Regexpç±»å‹

å‰é¢ä¸¤ç§æ–¹æ³•é€‚åˆäºç®€å•çš„æ­£åˆ™åŒ¹é…ï¼Œå¦‚æœæƒ³è¿›è¡Œå¤æ‚çš„åŒ¹é…ï¼Œéœ€è¦ä½¿ç”¨Regexpç±»å‹ã€‚åˆ›å»ºRegexpç±»å‹çš„æ–¹æ³•æœ‰å››ç§ã€‚

```go
func Compile(expr string) (*Regexp, error)

// è·ŸCompileæ–¹æ³•ç±»ä¼¼ï¼Œä½†è¯­æ³•ä¸ºegrepï¼Œä¸”åŒ¹é…è¯­ä¹‰æ”¹ä¸ºleftmost-longest
// Compileåˆ›å»ºå‡ºæ¥çš„Regexpå¯¹è±¡ä¹Ÿå¯ä»¥è°ƒç”¨Longestæ–¹æ³•ä¿®æ”¹åŒ¹é…è¯­ä¹‰
func CompilePOSIX(expr string) (*Regexp, error)

// è·ŸCompileç±»ä¼¼ï¼Œä½†è¯­æ³•é”™è¯¯ç›´æ¥panic
func MustCompile(str string) *Regexp

func MustCompilePOSIX(str string) *Regexp
```
### 4.1.1 åŒ¹é…æ“ä½œ

ä¼šæ£€æŸ¥æ˜¯å¦åŒ…å«å¯¹åº”æ­£åˆ™åŒ¹é…æ¨¡å¼ã€‚

```go
func (re *Regexp) Match(b []byte) bool
func (re *Regexp) MatchReader(r io.RuneReader) bool
func (re *Regexp) MatchString(s string) bool
```
## 4.2 æŸ¥æ‰¾æ“ä½œ

```go
// ç›´æ¥è¿”å›åŒ¹é…çš„ç¬¬ä¸€ä¸ªå­ä¸²
func (re *Regexp) Find(b []byte) []byte

// è¿”å›åŒ¹é…çš„æœ€å¤šnä¸ªå­ä¸²ï¼Œnå¦‚æœä¸ºè´Ÿï¼Œè¿”å›æ‰€æœ‰
func (re *Regexp) FindAll(b []byte, n int) [][]byte

// æŸ¥æ‰¾å¹¶è¿”å›æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ‰€æœ‰å­ä¸²çš„èµ·å§‹å’Œç»“æŸä½ç½®ï¼Œæœ€å¤šè¿”å›nä¸ªã€‚å¦‚æœnä¸ºè´Ÿæ•°ï¼Œåˆ™è¿”å›æ‰€æœ‰åŒ¹é…çš„å­ä¸²çš„ä½ç½®ã€‚
func (re *Regexp) FindAllIndex(b []byte, n int) [][]int

func (re *Regexp) FindAllString(s string, n int) []string
func (re *Regexp) FindAllStringIndex(s string, n int) [][]int

// æŸ¥æ‰¾å¹¶è¿”å›æ­£åˆ™è¡¨è¾¾å¼åœ¨Â `s`Â ä¸­åŒ¹é…çš„æ‰€æœ‰å­ä¸²åŠå…¶åˆ†ç»„ï¼Œæœ€å¤šè¿”å›Â `n`Â ä¸ªã€‚å¦‚æœÂ `n`Â ä¸ºè´Ÿæ•°ï¼Œåˆ™è¿”å›æ‰€æœ‰åŒ¹é…çš„å­ä¸²åŠå…¶åˆ†ç»„ã€‚
func (re *Regexp) FindAllStringSubmatch(s string, n int) [][]string
func (re *Regexp) FindAllStringSubmatchIndex(s string, n int) [][]int


func (re *Regexp) FindAllSubmatch(b []byte, n int) [][][]byte
func (re *Regexp) FindAllSubmatchIndex(b []byte, n int) [][]int

// æŸ¥æ‰¾å¹¶è¿”å›æ­£åˆ™è¡¨è¾¾å¼åœ¨Â bÂ ä¸­åŒ¹é…çš„ç¬¬ä¸€ä¸ªå­ä¸²çš„èµ·å§‹å’Œç»“æŸä½ç½®ã€‚å¦‚æœæ²¡æœ‰åŒ¹é…ï¼Œåˆ™è¿”å›Â nilã€‚
func (re *Regexp) FindIndex(b []byte) (loc []int)
func (re *Regexp) FindReaderIndex(r io.RuneReader) (loc []int)
func (re *Regexp) FindReaderSubmatchIndex(r io.RuneReader) []int

// æŸ¥æ‰¾å¹¶è¿”å›æ­£åˆ™è¡¨è¾¾å¼åœ¨Â `s`Â ä¸­åŒ¹é…çš„ç¬¬ä¸€ä¸ªå­ä¸²ã€‚å¦‚æœæ²¡æœ‰åŒ¹é…ï¼Œåˆ™è¿”å›ç©ºå­—ç¬¦ä¸²ã€‚
func (re *Regexp) FindString(s string) string
func (re *Regexp) FindStringIndex(s string) (loc []int)

// æŸ¥æ‰¾å¹¶è¿”å›æ­£åˆ™è¡¨è¾¾å¼åœ¨Â `s`Â ä¸­åŒ¹é…çš„ç¬¬ä¸€ä¸ªå­ä¸²åŠå…¶åˆ†ç»„ã€‚å¦‚æœæ²¡æœ‰åŒ¹é…ï¼Œåˆ™è¿”å›Â `nil`ã€‚
func (re *Regexp) FindStringSubmatch(s string) []string
func (re *Regexp) FindStringSubmatchIndex(s string) []int

func (re *Regexp) FindSubmatch(b []byte) [][]byte
func (re *Regexp) FindSubmatchIndex(b []byte) []int
```
### 4.2.1 æ›¿æ¢æ“ä½œ

```go
// ç”¨Â `repl`Â æ›¿æ¢Â `src`Â ä¸­æ‰€æœ‰åŒ¹é…Â `re`Â çš„å­ä¸²ã€‚
func (re *Regexp) ReplaceAll(src, repl []byte) []byte

// ç”¨Â `repl`Â å‡½æ•°çš„è¿”å›å€¼æ›¿æ¢Â `src`Â ä¸­æ‰€æœ‰åŒ¹é…Â `re`Â çš„å­ä¸²ã€‚`repl`Â å‡½æ•°æ¥æ”¶åŒ¹é…çš„å­ä¸²å¹¶è¿”å›æ›¿æ¢çš„å­—èŠ‚åˆ‡ç‰‡ã€‚
func (re *Regexp) ReplaceAllFunc(src []byte, repl func([]byte) []byte) []byte

// ç”¨Â `repl`Â å­—é¢å€¼æ›¿æ¢Â `src`Â ä¸­æ‰€æœ‰åŒ¹é…Â `re`Â çš„å­ä¸²ã€‚ä¸Â `ReplaceAll`Â ä¸åŒçš„æ˜¯ï¼Œ`ReplaceAllLiteral`Â ä¸ä¼šå¯¹Â `repl`Â è¿›è¡Œä»»ä½•ç‰¹æ®Šå¤„ç†ï¼ˆå¦‚è½¬ä¹‰ï¼‰ã€‚
func (re *Regexp) ReplaceAllLiteral(src, repl []byte) []byte

// ç”¨Â `repl`Â å­—é¢å€¼æ›¿æ¢Â `src`Â ä¸­æ‰€æœ‰åŒ¹é…Â `re`Â çš„å­ä¸²ã€‚ä¸Â `ReplaceAllString`Â ä¸åŒçš„æ˜¯ï¼Œ`ReplaceAllLiteralString`Â ä¸ä¼šå¯¹Â `repl`Â è¿›è¡Œä»»ä½•ç‰¹æ®Šå¤„ç†ï¼ˆå¦‚è½¬ä¹‰ï¼‰ã€‚
func (re *Regexp) ReplaceAllLiteralString(src, repl string) string

// ç”¨Â `repl`Â æ›¿æ¢Â `src`Â ä¸­æ‰€æœ‰åŒ¹é…Â `re`Â çš„å­ä¸²ã€‚
func (re *Regexp) ReplaceAllString(src, repl string) string

// ç”¨Â `repl`Â å‡½æ•°çš„è¿”å›å€¼æ›¿æ¢Â `src`Â ä¸­æ‰€æœ‰åŒ¹é…Â `re`Â çš„å­ä¸²ã€‚`repl`Â å‡½æ•°æ¥æ”¶åŒ¹é…çš„å­ä¸²å¹¶è¿”å›æ›¿æ¢çš„å­—ç¬¦ä¸²ã€‚
func (re *Regexp) ReplaceAllStringFunc(src string, repl func(string) string) string
```
### 4.2.2 åˆ‡å‰²æ“ä½œ

```go
// å°†åˆ‡ç‰‡ s æ‹†åˆ†ä¸ºç”±è¡¨è¾¾å¼åˆ†éš”çš„å­å­—ç¬¦ä¸²ï¼Œå¹¶è¿”å›è¿™äº›è¡¨è¾¾å¼åŒ¹é…ä¹‹é—´çš„å­å­—ç¬¦ä¸²åˆ‡ç‰‡ã€‚
func (re *Regexp) Split(s string, n int) []string
```

ç¤ºä¾‹ï¼š
```go
  
func main() {  
    rex := regexp.MustCompile(`a*`)  //å¦‚æœä¸åŒ…å«æ­£åˆ™å…ƒå­—ç¬¦å°±ç›¸å½“äºstrings.SplitN
    s := "abaabaccadaaae"  
    fmt.Println(rex.Split(s, 5))  
}

/*
[ b b c cadaaae]
*/
```
### 4.2.3 å…¶ä»–æ“ä½œ

```go
// è¿”å›æ­£åˆ™è¡¨è¾¾å¼çš„å­—ç¬¦ä¸²è¡¨ç¤ºã€‚
func (re *Regexp) String() string

// è¿”å›æ­£åˆ™è¡¨è¾¾å¼ä¸­çš„åˆ†ç»„æ•°é‡ã€‚
func (re *Regexp) NumSubexp() int
```
# 5 unicodeåŒ…ï¼šUnicodeç ç‚¹

ä¸–ç•Œä¸­çš„å­—ç¬¦æœ‰è®¸è®¸å¤šå¤šï¼Œæœ‰è‹±æ–‡ï¼Œä¸­æ–‡ï¼ŒéŸ©æ–‡ç­‰ã€‚æˆ‘ä»¬å¼ºçƒˆéœ€è¦ä¸€ä¸ªå¤§å¤§çš„æ˜ å°„è¡¨æŠŠä¸–ç•Œä¸Šçš„å­—ç¬¦æ˜ å°„æˆè®¡ç®—æœºå¯ä»¥é˜…è¯»çš„äºŒè¿›åˆ¶æ•°å­—ï¼ˆå­—èŠ‚ï¼‰ã€‚ è¿™æ ·ï¼Œæ¯ä¸ªå­—ç¬¦éƒ½ç»™äºˆä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„ç¼–ç ï¼Œå°±ä¸ä¼šå‡ºç°å†™æ–‡å­—çš„äººå’Œé˜…è¯»æ–‡å­—çš„äººç¼–ç ä¸åŒè€Œå‡ºç°æ— æ³•è¯»å–çš„ä¹±ç ç°è±¡äº†ã€‚

äºæ˜¯ Unicode å°±å‡ºç°äº†ï¼Œå®ƒæ˜¯ä¸€ç§æ‰€æœ‰ç¬¦å·çš„ç¼–ç æ˜ å°„ã€‚æœ€å¼€å§‹çš„æ—¶å€™ï¼Œunicode è®¤ä¸ºä½¿ç”¨ä¸¤ä¸ªå­—èŠ‚ï¼Œä¹Ÿå°±æ˜¯ 16 ä½å°±èƒ½åŒ…å«æ‰€æœ‰çš„å­—ç¬¦äº†ã€‚ ä½†æ˜¯éå¸¸å¯æƒœï¼Œä¸¤ä¸ªå­—èŠ‚æœ€å¤šåªèƒ½è¦†ç›– 65536 ä¸ªå­—ç¬¦ï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸å¤Ÿçš„ï¼Œäºæ˜¯é™„åŠ äº†ä¸€å¥—å­—ç¬¦ç¼–ç ï¼Œå³ unicode4.0ï¼Œé™„åŠ çš„å­—ç¬¦ç”¨ 4 ä¸ªå­—èŠ‚è¡¨ç¤ºã€‚ ç°åœ¨ä¸ºæ­¢ï¼Œå¤§æ¦‚ Unicode å¯ä»¥è¦†ç›– 100 å¤šä¸‡ä¸ªå­—ç¬¦äº†ã€‚

Unicode åªæ˜¯å®šä¹‰äº†ä¸€ä¸ªå­—ç¬¦å’Œä¸€ä¸ªç¼–ç çš„æ˜ å°„ï¼Œä½†æ˜¯å‘¢ï¼Œå¯¹åº”çš„å­˜å‚¨å´æ²¡æœ‰åˆ¶å®šã€‚ æ¯”å¦‚ä¸€ä¸ªç¼–ç  0x0041 ä»£è¡¨å¤§å†™å­—æ¯ Aï¼Œé‚£ä¹ˆå¯èƒ½æœ‰ä¸€ç§å­˜å‚¨è‡³å°‘æœ‰ 4 ä¸ªå­—èŠ‚ï¼Œé‚£å¯èƒ½ 0x00000041 æ¥å­˜å‚¨ä»£è¡¨ Aã€‚ è¿™ä¸ªå°±æ˜¯ unicode çš„å…·ä½“å®ç°ã€‚unicode çš„å…·ä½“å®ç°æœ‰å¾ˆå¤šç§ï¼ŒUTF-8 å’Œ UTF-16 å°±æ˜¯å…¶ä¸­ä¸¤ç§ã€‚

UTF-8 è¡¨ç¤ºæœ€å°‘ç”¨ä¸€ä¸ªå­—èŠ‚å°±èƒ½è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦çš„ç¼–ç å®ç°ã€‚å®ƒé‡‡å–çš„æ–¹å¼æ˜¯å¯¹ä¸åŒçš„è¯­è¨€ä½¿ç”¨ä¸åŒçš„æ–¹æ³•ï¼Œå°† unicode ç¼–ç æŒ‰ç…§è¿™ä¸ªæ–¹æ³•è¿›è¡Œè½¬æ¢ã€‚ æˆ‘ä»¬åªè¦è®°ä½æœ€åçš„ç»“æœæ˜¯è‹±æ–‡å ä¸€ä¸ªå­—èŠ‚ï¼Œä¸­æ–‡å ä¸‰ä¸ªå­—èŠ‚ã€‚è¿™ç§ç¼–ç å®ç°æ–¹å¼ä¹Ÿæ˜¯ç°åœ¨åº”ç”¨æœ€ä¸ºå¹¿æ³›çš„æ–¹å¼äº†ã€‚

UTF-16 è¡¨ç¤ºæœ€å°‘ç”¨ä¸¤ä¸ªå­—èŠ‚èƒ½è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦çš„ç¼–ç å®ç°ã€‚åŒæ ·æ˜¯å¯¹ unicode ç¼–ç è¿›è¡Œè½¬æ¢ï¼Œå®ƒçš„ç»“æœæ˜¯è‹±æ–‡å ç”¨ä¸¤ä¸ªå­—èŠ‚ï¼Œä¸­æ–‡å ç”¨ä¸¤ä¸ªæˆ–è€…å››ä¸ªå­—èŠ‚ã€‚ å®é™…ä¸Šï¼ŒUTF-16 å°±æ˜¯æœ€ä¸¥æ ¼å®ç°äº† unicode4.0ã€‚ä½†ç”±äºè‹±æ–‡æ˜¯æœ€é€šç”¨çš„è¯­è¨€ï¼Œæ‰€ä»¥æ¨å¹¿ç¨‹åº¦æ²¡æœ‰ UTF-8 é‚£ä¹ˆæ™®åŠã€‚

go å¯¹ unicode çš„æ”¯æŒåŒ…å«ä¸‰ä¸ªåŒ… :

- unicode
- unicode/utf8
- unicode/utf16

unicode åŒ…åŒ…å«åŸºæœ¬çš„å­—ç¬¦åˆ¤æ–­å‡½æ•°ã€‚utf8 åŒ…ä¸»è¦è´Ÿè´£ rune å’Œ byte ä¹‹é—´çš„è½¬æ¢ã€‚utf16 åŒ…è´Ÿè´£ rune å’Œ uint16 æ•°ç»„ä¹‹é—´çš„è½¬æ¢ã€‚

ç”±äºå­—ç¬¦çš„æ¦‚å¿µæœ‰çš„æ—¶å€™æ¯”è¾ƒæ¨¡ç³Šï¼Œæ¯”å¦‚å­—ç¬¦ï¼ˆå°å†™ aï¼‰æ™®é€šæ˜¾ç¤ºä¸º aï¼Œåœ¨é‡éŸ³å­—ç¬¦ä¸­ï¼ˆgrave-accentedï¼‰ä¸­æ˜¾ç¤ºä¸ºÃ ã€‚ è¿™æ—¶å€™å­—ç¬¦ï¼ˆcharacterï¼‰çš„æ¦‚å¿µå°±æœ‰ç‚¹ä¸å‡†ç¡®äº†ï¼Œå› ä¸º a å’ŒÃ æ˜¾ç„¶æ˜¯ä¸¤ä¸ªä¸åŒçš„ unicode ç¼–ç ï¼Œä½†æ˜¯å´ä»£è¡¨åŒä¸€ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥å¼•å…¥äº† runeã€‚ ä¸€ä¸ª rune å°±ä»£è¡¨ä¸€ä¸ª unicode ç¼–ç ï¼Œæ‰€ä»¥ä¸Šé¢çš„ a å’ŒÃ æ˜¯ä¸¤ä¸ªä¸åŒçš„ runeã€‚

è¿™é‡Œæœ‰ä¸ªè¦æ³¨æ„çš„äº‹æƒ…ï¼Œgo è¯­è¨€çš„æ‰€æœ‰ä»£ç éƒ½æ˜¯ UTF8 çš„ï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬åœ¨ç¨‹åºä¸­çš„å­—ç¬¦ä¸²éƒ½æ˜¯ utf8 ç¼–ç çš„ï¼Œä½†æ˜¯æˆ‘ä»¬çš„å•ä¸ªå­—ç¬¦ï¼ˆå•å¼•å·æ‰©èµ·æ¥çš„ï¼‰å´æ˜¯ unicode çš„ã€‚
## 5.1 unicodeåŒ…

å¸¸ç”¨å‡½æ•°ï¼š

```go
func IsControl(r rune) bool  // æ˜¯å¦æ§åˆ¶å­—ç¬¦
func IsDigit(r rune) bool  // æ˜¯å¦é˜¿æ‹‰ä¼¯æ•°å­—å­—ç¬¦ï¼Œå³ 0-9
func IsGraphic(r rune) bool // æ˜¯å¦å›¾å½¢å­—ç¬¦
func IsLetter(r rune) bool // æ˜¯å¦å­—æ¯
func IsLower(r rune) bool // æ˜¯å¦å°å†™å­—ç¬¦
func IsMark(r rune) bool // æ˜¯å¦ç¬¦å·å­—ç¬¦
func IsNumber(r rune) bool // æ˜¯å¦æ•°å­—å­—ç¬¦ï¼Œæ¯”å¦‚ç½—é©¬æ•°å­—â…§ä¹Ÿæ˜¯æ•°å­—å­—ç¬¦
func IsOneOf(ranges []*RangeTable, r rune) b ool // æ˜¯å¦æ˜¯ RangeTable ä¸­çš„ä¸€ä¸ª
func IsPrint(r rune) bool // æ˜¯å¦å¯æ‰“å°å­—ç¬¦
func IsPunct(r rune) bool // æ˜¯å¦æ ‡ç‚¹ç¬¦å·
func IsSpace(r rune) bool // æ˜¯å¦ç©ºæ ¼
func IsSymbol(r rune) bool // æ˜¯å¦ç¬¦å·å­—ç¬¦
func IsTitle(r rune) bool // æ˜¯å¦ title case
func IsUpper(r rune) bool // æ˜¯å¦å¤§å†™å­—ç¬¦
func Is(rangeTab *RangeTable, r rune) bool // r æ˜¯å¦ä¸º rangeTab ç±»å‹çš„å­—ç¬¦
func In(r rune, ranges ...*RangeTable) bool  // r æ˜¯å¦ä¸º ranges ä¸­ä»»æ„ä¸€ä¸ªç±»å‹çš„å­—ç¬¦
```
## 5.2 utf8 åŒ…

utf8 é‡Œé¢çš„å‡½æ•°å°±æœ‰ä¸€äº›å­—èŠ‚å’Œå­—ç¬¦çš„è½¬æ¢ã€‚

åˆ¤æ–­æ˜¯å¦ç¬¦åˆ utf8 ç¼–ç çš„å‡½æ•°ï¼š

- func Valid(p \[]byte) bool
- func ValidRune(r rune) bool
- func ValidString(s string) bool

åˆ¤æ–­ rune æ‰€å å­—èŠ‚æ•°ï¼š

- func RuneLen(r rune) int

åˆ¤æ–­å­—èŠ‚ä¸²æˆ–è€…å­—ç¬¦ä¸²çš„ rune æ•°ï¼š

- func RuneCount(p \[]byte) int
- func RuneCountInString(s string) (n int)

ç¼–ç å’Œè§£ç åˆ° runeï¼š

- func EncodeRune(p \[]byte, r rune) int
- func DecodeRune(p \[]byte) (r rune, size int)
- func DecodeRuneInString(s string) (r rune, size int)
- func DecodeLastRune(p \[]byte) (r rune, size int)
- func DecodeLastRuneInString(s string) (r rune, size int)

æ˜¯å¦ä¸ºå®Œæ•´ runeï¼š

- func FullRune(p \[\]byte) bool
- func FullRuneInString(s string) bool

æ˜¯å¦ä¸º rune ç¬¬ä¸€ä¸ªå­—èŠ‚ï¼š

- func RuneStart(b byte) bool

ç¤ºä¾‹ï¼š

```go
word:=[]byte("ç•Œ")

fmt.Println(utf8.Valid(word[:2]))
fmt.Println(utf8.ValidRune('ç•Œ'))
fmt.Println(utf8.ValidString("ä¸–ç•Œ"))

fmt.Println(utf8.RuneLen('ç•Œ'))

fmt.Println(utf8.RuneCount(word))
fmt.Println(utf8.RuneCountInString("ä¸–ç•Œ"))

p:=make([]byte,3)
utf8.EncodeRune(p,'å¥½')
fmt.Println(p)
fmt.Println(utf8.DecodeRune(p))
fmt.Println(utf8.DecodeRuneInString("ä½ å¥½"))
fmt.Println(utf8.DecodeLastRune([]byte("ä½ å¥½")))
fmt.Println(utf8.DecodeLastRuneInString("ä½ å¥½"))

fmt.Println(utf8.FullRune(word[:2]))
fmt.Println(utf8.FullRuneInString("ä½ å¥½"))

fmt.Println(utf8.RuneStart(word[1]))
fmt.Println(utf8.RuneStart(word[0]))
```

è¿è¡Œç»“æœï¼š

```
false
true
true
3
1
2
[229 165 189]
22909 3
20320 3
22909 3
22909 3
false
true
false
true
```

## 5.3 utf16 åŒ…

utf16 çš„åŒ…çš„å‡½æ•°å°±æ¯”è¾ƒå°‘äº†ã€‚

å°† uint16 å’Œ rune è¿›è¡Œè½¬æ¢

```go
func Encode(s []rune) []uint16
func EncodeRune(r rune) (r1, r2 rune)
func Decode(s []uint16) []rune
func DecodeRune(r1, r2 rune) rune
func IsSurrogate(r rune) bool // æ˜¯å¦ä¸ºæœ‰æ•ˆä»£ç†å¯¹
```

unicode æœ‰ä¸ªåŸºæœ¬å­—ç¬¦å¹³é¢å’Œå¢è¡¥å¹³é¢çš„æ¦‚å¿µï¼ŒåŸºæœ¬å­—ç¬¦å¹³é¢åªæœ‰ 65535 ä¸ªå­—ç¬¦ï¼Œå¢è¡¥å¹³é¢ï¼ˆæœ‰ 16 ä¸ªï¼‰åŠ ä¸Šå»å°±èƒ½è¡¨ç¤º 1114112 ä¸ªå­—ç¬¦ã€‚ utf16 å°±æ˜¯ä¸¥æ ¼å®ç°äº† unicode çš„è¿™ç§ç¼–ç è§„èŒƒã€‚

è€ŒåŸºæœ¬å­—ç¬¦å’Œå¢è¡¥å¹³é¢å­—ç¬¦å°±æ˜¯ä¸€ä¸ªä»£ç†å¯¹ï¼ˆSurrogate Pairï¼‰ã€‚ä¸€ä¸ªä»£ç†å¯¹å¯ä»¥å’Œä¸€ä¸ª rune è¿›è¡Œè½¬æ¢ã€‚

ç¤ºä¾‹ï¼š

```go
words :=[]rune{'ğ“','ğ“‘'}

u16:=utf16.Encode(words)
fmt.Println(u16)
fmt.Println(utf16.Decode(u16))

r1,r2:=utf16.EncodeRune('ğ“')
fmt.Println(r1,r2)
fmt.Println(utf16.DecodeRune(r1,r2))
fmt.Println(utf16.IsSurrogate(r1))
fmt.Println(utf16.IsSurrogate(r2))
fmt.Println(utf16.IsSurrogate(1234))
```

è¾“å‡ºç»“æœï¼š

```go
[55349 56528 55349 56529]
[120016 120017]
55349 56528
120016
true
true
false
```



# 6 å­—ç¬¦ä¸²æ‹¼æ¥æ–¹æ³•æ±‡æ€»