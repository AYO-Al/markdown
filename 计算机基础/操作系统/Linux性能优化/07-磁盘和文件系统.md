
linux中一切皆文件，但我们平时所说的文件其实是普通文件，在访问普通文件时，会先访问文件系统，然后由文件系统来操作磁盘。
还有一种叫块设备文件，可以通过该文件直接访问磁盘，也叫做 "裸IO"。

磁盘提供了最基础的持久化存储，而文件系统则是在这之上提供了一个用来管理文件的树状结构
# 磁盘性能

使用率、饱和度、IOPS、吞吐量以及响应时间等。这五个指标，是衡量磁盘性能的基本指标。

•  使用率，是指磁盘处理I/O的时间百分比。过高的使用率（比如超过80%），通常意味着磁盘 I/O 存在性能瓶颈。
•  饱和度，是指磁盘处理 I/O 的繁忙程度。过高的饱和度，意味着磁盘存在严重的性能瓶颈。当饱和度为 100% 时，磁盘无法接受新的 I/O 请求。
•  IOPS（Input/Output Per Second），是指每秒的 I/O 请求数。
•  吞吐量，是指每秒的 I/O 请求大小。
•  响应时间，是指 I/O 请求从发出到收到响应的间隔时间

> iostat

使用 `iostat -d -x` 命令查看io指标

| 指标            | 全称与含义                 | 解读要点与参考值                                                           |
| ------------- | --------------------- | ------------------------------------------------------------------ |
| **r/s**​      | **每秒读I/O请求数**​        | 直接反映磁盘的读取压力。                                                       |
| **w/s**​      | **每秒写I/O请求数**​        | 直接反映磁盘的写入压力。                                                       |
| **rkB/s**​    | **每秒从磁盘读取的数据量 (KB)**​ | 衡量读吞吐量。                                                            |
| **wkB/s**​    | **每秒向磁盘写入的数据量 (KB)**​ | 衡量写吞吐量。                                                            |
| **rrqm/s**​   | **每秒合并的读请求数**         | 值较高表明系统优化了读操作（合并相邻磁盘块的请求）。                                         |
| **wrqm/s**​   | **每秒合并的写请求数**         | 值较高表明系统优化了写操作。                                                     |
| **%rrqm**​    | **读请求合并百分比**​         | 合并的读请求占总读请求的百分比。                                                   |
| **%wrqm**​    | **写请求合并百分比**​         | 合并的写请求占总写请求的百分比。                                                   |
| **r_await**​  | **读I/O平均等待时间 (毫秒)**   | **关键指标**。包括队列等待时间和磁盘服务时间。**通常应低于5ms**，若**大于10ms**则表示延迟较高。          |
| **w_await**​  | **写I/O平均等待时间 (毫秒)**   | 同 `r_await`，针对写操作。                                                 |
| **aqu-sz**​   | **平均I/O队列长度**         | **关键指标**。等待处理的I/O请求数量的平均值。该值应尽可能小，若**持续大于1**，可能表示设备已出现拥堵。          |
| **rareq-sz**​ | **读请求的平均大小 (KB)**​    | 平均每次读操作的数据量。                                                       |
| **wareq-sz**​ | **写请求的平均大小 (KB)**​    | 平均每次写操作的数据量。                                                       |
| **svctm**​    | **I/O平均服务时间 (毫秒)**​   | 此指标**已逐渐被废弃**，建议重点参考 `await`。                                      |
| **%util**​    | **设备带宽利用率**           | **核心瓶颈指标**。设备有I/O（即非空闲）的时间比率。如果**接近100%**，表示设备处理I/O的时间已满负荷，可能存在瓶颈。 |

这些指标中，你要注意：
•  %util  ，就是我们前面提到的磁盘I/O使用率；
•  r/s+  w/s  ，就是 IOPS；
•  rkB/s+wkB/s ，就是吞吐量；
•  r_await+w_await ，就是响应时间。
在观测指标时，也别忘了结合请求的大小（ rareq-sz 和wareq-sz）一起分析。

![[Pasted image 20260107221713.png]]