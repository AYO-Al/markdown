
> 路由协议

- 路由协议的目标：确定从发送主机到接收主机之间，通过路由器的网络较好的路径
- 路径：路由器的序列，分组将沿着该序列从源主机到达最后的目标主机
- 较好：最小代价，最快的，最不拥塞的
- 在路由计算中按照子网到子网的路径计算为目标，而不是主机到主机

> 最优化原则

- 汇集树(slink tree)：
	- 此节点到其他节点的最优路径形成的树
	- 路由选择算法就是为所有路由器找到并使用汇集树

> 路由的原则

路由选择算法的原则：

- 正确性： 
- 简单性：
- 健壮性：

# 路由算法分类

> 路由信息分为全局和局部的

- 全局：所有的路由器拥有完整的拓扑和边的代价信息
	- link state 算法
- 分布式：路由器只知道与它有物理连接关系的邻居路由器，和到相应邻居路由器的代价值。迭代的与邻居交换路由器信息、计算路由信息
	- distance vector 算法

> 静态路由和动态路由

- 静态：路由随时间缓慢变化
- 动态：路由变化很快，周期性更新，根据链路代价的变化而变化
# lS路由算法

> 路由算法工作过程

> 链路状态路由选择(link state routing)基本工作过程

1. 发现相邻节点，获知对方网络地址
2. 测量到相邻节点的代价（延迟，开销）
3. 组装一个LS分组，描述它到相邻节点的代价情况
4. 将分组通过扩散的方法发到所有其他路由器
5. 通过 `Dijkstra` 算法找出最短路径（这才是路由算法）
	1. 每个节点独立计算出来到其他节点的最短路径
	2. 迭代算法：第k步能够知道本节点到k个其他节点的最短路径
# DV算法算法

> 距离矢量路由选择

- 基本思路：
	- 各路由器维护一张路由表
	- 各路由器与相邻路由器交换路由表
	- 根据获取的路由信息更新路由表 
- 
# 自治系统中的路由选择

## RIP

> RIP：Routing Information Protocol

- Distance vector算法
	- 距离矢量：每条链路cost=1，最大为15hops，超过标记为不可达
	- DV每隔30s和邻居交换DV，通告
	- 在对方的请求下可以发送通知报文
	- 每个通告包括最多25个目标子网

> 链路失效和恢复

如果180秒没有收到通告信息--》 邻居或者链路失效
- 发现经过这个邻居的路由已经失效
- 新的通告报文会传递给邻居
- 邻居会因此发出新的通告
- 链路失效快速的在整网中传输
- 使用毒性逆转阻止ping-pong回路

> RIP进程处理

- RIP以应用进程的方式实现：route-d(daemon)
- 通告报文通过UDP报文传送，周期性重复
- 网络层的协议使用了传输层的服务，以应用层实体的方式实现

## OSPF

> OSPF：Open Shortest Path First

- open：标准可公开获得
- 使用LS算法：
	- LS分组在网络中分发
	- 全局网络拓扑、代价在每一个节点中保存
	- 路由计算采用 Dijkstra 算法
- OSPF通告信息中携带：每一个邻居路由器一个表项
- 通告信息会传遍全部网络（通过泛洪）
	- 在IP数据报上直接传送OSPF报文
- IS-IS路由协议：几乎跟OSPF一致
# ISP之间的路由选择

## BGP

> BGP（Border Gateway Protocol）：自治区域路由协议

- 事实上的标准
- 将互联网上各个AS粘在一起的胶水

- BGP提供给每个AS以下方法
	- EBGP：从相邻的Ases那里获取子网可达信息
	- iBGP：将获得的子网可达信息传遍到AS内部的所有路由器
	- 根据子网可达信息和策略来决定到达子网的好路径
- 允许子网向互联网通告其位置
- 基于路径矢量算法
	- 不仅仅是路径矢量，还包括达到各个目标网络的详细路径（AS序号列表），能够避免简单DV算法的路由环路问题
# SDN控制平面

